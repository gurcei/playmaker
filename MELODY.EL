#OUTPUT PLAYMAKER' ÀEYS:' ----'    ’P ARROW = ÕOVE TO PREVIOUS VOICE'  ƒOWN ARROW = ÕOVE TO NEXT VOICE'  ÃEFT ARROW = ÕOVE LEFT WITHIN CURRRENT VOIE STRING' “IGHT ARROW = ÕOVE RIGHT WITHIN CURRENT VOIE STRING'    …Œ”‘/ƒ≈Ã = ƒELETE CHAR IN CURRENT VOICE STRING'       ≈”√,  = ÕOVE TO START OF CURRENT VOICE STRING'       ≈”√,À = ÕOVE TO END OF CURRENT VOICE STRING'      √‘“Ã+◊ = ÕOVE FORWARD ONE WORD IN CURRENT VOICE STRING'      √‘“Ã+’ = ÕOVE BACK ONE WORD IN CURRENT VOICE STRING'           < = ”HOW PREVIOUS SONG CHUNK'           > = ”HOW NEXT SONG CHUNK'           - = ƒECREASE TEMPO'           + = …NCREASE TEMPO'       ¡Ã‘+— = —UIT PROGRAM'          ∆1 = ÃOAD'          ∆3 = ”AVE'          ∆7 = ≈NVELOPE EDITORTRAP RUNSTOPØTRAPPER.DECLARATIONS'------------#DECLARE CHUNKØIDX = 0#DECLARE CHUNKØCNT = 0#DEFINE CHUNKØMAX = 20#DECLARE VIDX, IDX#DECLARE CURSORØX = 0#DECLARE CURSORØY = 0#DECLARE V$(5,CHUNKØMAX)#DECLARE KEY$#DECLARE VALID$="CDEFGAB0123456789 #$.HIQRSWOTUXMPL"#DECLARE VAL$#DECLARE TMPO% = 12#DECLARE ESCØFLAG% = 0#STRUCT ≈Œ÷‘Ÿ–≈ NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW≈Œ÷‘Ÿ–≈ ENVS(9) = [ _  [ "–IANO",       0,  9,  0,  0,  2, 1536 ], _  [ "¡CCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "√ALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "ƒRUM",        0,  5,  5,  0,  3,    0 ], _  [ "∆LUTE",       9,  4,  4,  0,  0,    0 ], _  [ "«UITAR",      0,  9,  2,  1,  1,    0 ], _  [ "»ARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "œRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "‘RUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ÿYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DECLARE ROW, COL, SROW, SCOL, A$, V, MAXV, V$#STRUCT À≈ŸØ‘Ÿ–≈ IN$, OUT$À≈ŸØ‘Ÿ–≈ KEYS(11) = [ _  [ "A", "C", ], _  [ "W", "#C", ], _  [ "S", "D", ], _  [ "E", "#D", ], _  [ "D", "E", ], _  [ "F", "F", ], _  [ "T", "#F", ], _  [ "G", "G", ], _  [ "Y", "#G", ], _  [ "H", "A", ], _  [ "U", "#A", ], _  [ "J", "B", ] _]#DECLARE PSTR$, K, DELTA#DECLARE WNAME$(4)WNAME$(0) = "‘“…"WNAME$(1) = "”¡◊"WNAME$(2) = "–’Ã”≈"WNAME$(3) = "Œœ…”≈"WNAME$(4) = "“…Œ«"PRINT "ì"PLAY : PLAY "".MAIN'----  KEY OFF  GOSUB DRAWØEDITORØSCREEN  GOSUB USERØINPUT  GOTO MAIN.DRAWØEDITORØSCREEN'------------------  CURSOR 0,0:PRINT "PLAYMAKER V0.01 - BY  GURCE ISIKYILDIZ"  GOSUB DRAWØCURRENTØCHUNK  RETURN.DRAWØCURRENTØCHUNK'------------------  PRINT "ì"  PRINT "TEMPO:      ùùùùù"; TMPO%  PRINT "CHUNKØIDX:    ùùù"; CHUNKØIDX       FOR VIDX=0 TO 5    IF CURSORØY <> VIDX THEN BEGIN      CURSOR 0,5+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX;": ";V$(VIDX,CHUNKØIDX);    BEND:ELSE BEGIN      CURSOR 0,5+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX;": ";      FOR IDX=1 TO LEN(V$(VIDX,CHUNKØIDX))        IF CURSORØX = IDX-1 THEN BEGIN          PRINT "";MID$(V$(VIDX,CHUNKØIDX),IDX,1);"í";        BEND:ELSE BEGIN          PRINT MID$(V$(VIDX,CHUNKØIDX),IDX,1);        BEND      NEXT IDX      IF LEN(V$(VIDX,CHUNKØIDX)) = 0 OR CURSORØX=LEN(V$(VIDX,CHUNKØIDX)) THEN PRINT " í";    BEND  NEXT VIDX  RETURN.CHECKØVALIDØKEY'---------------  FOR IDX=1 TO LEN(VALID$)    VAL$=MID$(VALID$,IDX,1)    IF KEY$= VAL$ THEN BEGIN      IF CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN        V$(CURSORØY,CHUNKØIDX) = LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX) _          + VAL$ + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)        CURSORØX=CURSORØX+1        RETURN      BEND      V$(CURSORØY,CHUNKØIDX)=V$(CURSORØY,CHUNKØIDX)+VAL$      CURSORØX=CURSORØX+1      RETURN    BEND  NEXT IDX  RETURN.FORWARDØWORD'------------  IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  RETURN.PREVIOUSØWORD'-------------  IF CURSORØX = 0 THEN RETURN  IF CURSORØX = 1 THEN CURSORØX = 0: RETURN  CURSORØX = CURSORØX - 1  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  CURSORØX=CURSORØX+1  RETURN.LOAD'----  INPUT "LOAD NAME: ";KEY$  IF KEY$="" THEN RETURN  DOPEN #2,(KEY$),R,U8  ' LOAD MELODY CHUNKS  ' ------------------  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  INPUT #2,TMPO%  ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, ENVSØNAME$(ROW)    INPUT #2, ENVSØATTACK(ROW)    INPUT #2, ENVSØDECAY(ROW)    INPUT #2, ENVSØSUSTAIN(ROW)    INPUT #2, ENVSØRELEASE(ROW)    INPUT #2, ENVSØWAVEFORM(ROW)    INPUT #2, ENVSØPW(ROW)    GOSUB SETØENV  NEXT ROW  DCLOSE #2  CHUNKØIDX = 0  RETURN.SAVE'----  INPUT "SAVE NAME: ";KEY$  IF KEY$="" THEN RETURN    DELETE (KEY$)  DOPEN #2,(KEY$),W,U8  ' SAVE MELODY CHUNKS  ' ------------------  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    FOR VIDX=0 TO 5      PRINT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  PRINT #2,TMPO%  ' SAVE ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT #2, ENVSØNAME$(ROW)    PRINT #2, ENVSØATTACK(ROW)    PRINT #2, ENVSØDECAY(ROW)    PRINT #2, ENVSØSUSTAIN(ROW)    PRINT #2, ENVSØRELEASE(ROW)    PRINT #2, ENVSØWAVEFORM(ROW)    PRINT #2, ENVSØPW(ROW)  NEXT ROW  DCLOSE #2  CHUNKØIDX = 0  RETURN.SAVEØASØTEXT'------------  INPUT "SAVE (AS TEXT) NAME: ";KEY$  IF KEY$="" THEN RETURN  DELETE (KEY$)      DOPEN #2,(KEY$),W,U8  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    FOR VIDX=0 TO 5      PRINT #2, "V";CHR$(49+VIDX);"$(";STR$(CHUNKØIDX);")=";      PRINT #2, CHR$(34);V$(VIDX, CHUNKØIDX);CHR$(34)    NEXT VIDX      PRINT #2, ""  NEXT CHUNKØIDX  DCLOSE #2  CHUNKØIDX = 0  RETURN.USERØINPUT'----------  GETKEY KEY$  ' DOWN ARROW?  IF KEY$="" AND CURSORØY<5 THEN BEGIN    CURSORØY = CURSORØY + 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN CURSORØX = _      LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' UP ARROW?  IF KEY$="ë" AND CURSORØY>0 THEN BEGIN    CURSORØY = CURSORØY - 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN _      CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' RIGHT ARROW?  IF KEY$="" AND CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN    CURSORØX=CURSORØX+1  BEND  ' LEFT ARROW?  IF KEY$="ù" AND CURSORØX > 0 THEN CURSORØX=CURSORØX-1  ' BACKSPACE (INST/DEL)?  IF KEY$="" AND CURSORØX > 0 THEN BEGIN    V$(CURSORØY,CHUNKØIDX)=LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX-1) _      + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)    CURSORØX=CURSORØX-1  BEND  IF ESCØFLAG% THEN BEGIN    ESCØFLAG%=0    IF KEY$ = "J" THEN BEGIN:CURSORØX=0:BEND    IF KEY$ = "K" THEN BEGIN:CURSORØX=LEN(V$(CURSORØY,CHUNKØIDX)):BEND    KEY$=""  BEND  IF KEY$=CHR$(27) THEN ESCØFLAG%=ABS(ESCØFLAG%-1)  ' CTRL-W = FORWARD ONE WORD  IF KEY$="" THEN GOSUB FORWARDØWORD  ' CTRL-U = BACK ONE WORD  IF KEY$="" THEN GOSUB PREVIOUSØWORD  ' < / > = PREVIOUS/NEXT CHUNK  IF KEY$="<" AND CHUNKØIDX>0 THEN BEGIN    CHUNKØIDX=CHUNKØIDX-1    CURSORØX=0  BEND  IF KEY$=">" AND CHUNKØIDX<CHUNKØMAX THEN BEGIN    CHUNKØIDX=CHUNKØIDX+1    CURSORØX=0  BEND  ' +/- = TEMPO CHANGE  IF KEY$="-" THEN TMPO%=TMPO%-1  IF KEY$="+" THEN TMPO%=TMPO%+1  ' ALT-Q = EXIT  IF KEY$="´" THEN BEGIN    PRINT "ARE YOU SURE? (Y/N)"    GET KEY A$    IF A$="Y" THEN KEY ON:END  BEND  IF KEY$="Ö" THEN GOSUB LOAD  IF KEY$="Ü" THEN GOSUB SAVE  IF KEY$="à" THEN GOSUB ENVELOPEØEDITOR  ' ∆4 = SAVE AS TEXT  IF KEY$="ä" THEN GOSUB SAVEØASØTEXT  ' RETURN=PLAY ROW  IF KEY$=CHR$(13) THEN TEMPO TMPO% : PLAY V$(CURSORØY,CHUNKØIDX)  ' SHIFT+RETURN=PLAY ALL CHANNELS  IF KEY$=CHR$(141) THEN BEGIN    TEMPO TMPO%    PLAY V$(0,CHUNKØIDX), V$(1,CHUNKØIDX), _    V$(2,CHUNKØIDX), V$(3,CHUNKØIDX), V$(4,CHUNKØIDX), _    V$(5,CHUNKØIDX)  BEND  GOSUB CHECKØVALIDØKEY  RETURN.ENVELOPEØEDITOR'---------------  DO WHILE 1    GOSUB DRAWØTABLE    GOSUB GETØUSERØINPUTØFORØTABLE    ' ALT+Q TO EXIT    IF A$="´" THEN EXIT  LOOP  RETURN.DRAWØTABLE'----------  PRINT "ìENV EDITOR"  PRINT " ----------"  PRINT  PRINT "   Œ¡Õ≈";CHR$(9);CHR$(9);"¡‘‘¡√À";CHR$(9);"ƒ≈√¡Ÿ";CHR$(9);"”’”‘¡…Œ";CHR$(9);"“≈Ã≈¡”≈";CHR$(9);  PRINT "◊¡÷≈∆“Õ";CHR$(9);"–’Ã”≈◊…ƒ‘»"  FOR ROW = 0 TO 9    PRINT ROW;" : ";    COL = 0 : V$ = ENVSØNAME$(ROW)    GOSUB SHOWØCELL    COL = 1 : V = ENVSØATTACK(ROW)    GOSUB SHOWØCELL    COL = 2 : V = ENVSØDECAY(ROW)    GOSUB SHOWØCELL    COL = 3 : V = ENVSØSUSTAIN(ROW)    GOSUB SHOWØCELL    COL = 4 : V = ENVSØRELEASE(ROW)    GOSUB SHOWØCELL    COL = 5 : V = ENVSØWAVEFORM(ROW)    GOSUB SHOWØCELL    COL = 6 : V = ENVSØPW(ROW)    GOSUB SHOWØCELL    PRINT  NEXT ROW  RETURN.GETØVAL'-------  IF SCOL = 0 THEN V$ = ENVSØNAME$(SROW)  IF SCOL = 1 THEN V = ENVSØATTACK(SROW)  IF SCOL = 2 THEN V = ENVSØDECAY(SROW)  IF SCOL = 3 THEN V = ENVSØSUSTAIN(SROW)  IF SCOL = 4 THEN V = ENVSØRELEASE(SROW)  IF SCOL = 5 THEN V = ENVSØWAVEFORM(SROW)  IF SCOL = 6 THEN V = ENVSØPW(SROW)  RETURN.SHOWØCELL'---------  IF SROW=ROW AND SCOL = COL THEN PRINT "";:ELSE PRINT "í";  IF COL = 0 THEN BEGIN    PRINT V$;CHR$(9);"í";    RETURN  BEND  IF COL = 5 THEN BEGIN    PRINT WNAME$(V);CHR$(9);"í";    RETURN  BEND  ' ELSE  PRINT V;CHR$(9);"í";  RETURN.GETØUSERØINPUTØFORØTABLE'------------------------  GET KEY A$  IF A$ = "ù" AND SCOL > 0 THEN SCOL = SCOL - 1  IF A$ = "" AND SCOL < 6 THEN SCOL = SCOL + 1  IF A$ = "ë" AND SROW > 0 THEN SROW = SROW - 1  IF A$ = "" AND SROW < 9 THEN SROW = SROW + 1  IF A$ = "+" THEN DELTA=1 : GOSUB INCRØVAL  IF A$ = "-" THEN DELTA=1 : GOSUB DECRØVAL  IF A$ = "€" THEN DELTA=100 : GOSUB INCRØVAL  IF A$ = "›" THEN DELTA=100 : GOSUB DECRØVAL  IF A$ = CHR$(13) AND SCOL = 0 THEN GOSUB CHANGEØENVØNAME  GOSUB CHECKØPIANOØKEYS  RETURN.CHANGEØENVØNAME'---------------  INPUT "NEW NAME: ",V$  IF V$<>"" THEN ENVSØNAME$(SROW) = V$  RETURN.CHECKØPIANOØKEYS'----------------  PSTR$ = ""  FOR K = 0 TO 11    IF A$ = KEYSØIN$(K) THEN PSTR$ = KEYSØOUT$(K)  NEXT K  IF LEN(PSTR$)>0 THEN BEGIN    PLAY "O5QT"+STR$(SROW)+PSTR$  BEND  RETURN.INCRØVAL'--------  GOSUB GETØVAL  MAXV = 15  IF SCOL = 5 THEN MAXV = 4  IF SCOL = 6 THEN MAXV = 4095  V = V + DELTA  IF V > MAXV THEN V = MAXV  GOSUB APPLYØVAL  RETURN.DECRØVAL'--------  GOSUB GETØVAL  V = V - DELTA  IF V < 0 THEN V = 0  GOSUB APPLYØVAL  RETURN.APPLYØVAL'---------  IF SCOL=0 THEN ENVSØNAME$(SROW) = V$  IF SCOL=1 THEN ENVSØATTACK(SROW) = V  IF SCOL=2 THEN ENVSØDECAY(SROW) = V  IF SCOL=3 THEN ENVSØSUSTAIN(SROW) = V  IF SCOL=4 THEN ENVSØRELEASE(SROW) = V  IF SCOL=5 THEN ENVSØWAVEFORM(SROW) = V  IF SCOL=6 THEN ENVSØPW(SROW) = V  ROW = SROW  GOSUB SETØENV  RETURN.SETØENV'-------  ENVELOPE ROW, ENVSØATTACK(ROW), ENVSØDECAY(ROW), ENVSØSUSTAIN(ROW), ENVSØRELEASE(ROW), ENVSØWAVEFORM(ROW), ENVSØPW(ROW)  RETURN.RUNSTOPØTRAPPER'---------------  IF ER=30 THEN RESUME  ' IGNORE RUN/STOP  TRAP  PRINT ERR$(ER);" ERROR"  PRINT " IN LNE";EL  END