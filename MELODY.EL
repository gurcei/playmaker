#OUTPUT PLAYMAKER' ÀEYS:' ----'    ’P ARROW = ÕOVE TO PREVIOUS VOICE'  ƒOWN ARROW = ÕOVE TO NEXT VOICE'  ÃEFT ARROW = ÕOVE LEFT WITHIN CURRRENT VOIE STRING' “IGHT ARROW = ÕOVE RIGHT WITHIN CURRENT VOIE STRING'    …Œ”‘/ƒ≈Ã = ƒELETE CHAR IN CURRENT VOICE STRING'       ≈”√,  = ÕOVE TO START OF CURRENT VOICE STRING'       ≈”√,À = ÕOVE TO END OF CURRENT VOICE STRING'      √‘“Ã+◊ = ÕOVE FORWARD ONE WORD IN CURRENT VOICE STRING'      √‘“Ã+’ = ÕOVE BACK ONE WORD IN CURRENT VOICE STRING'           < = ”HOW PREVIOUS SONG CHUNK'           > = ”HOW NEXT SONG CHUNK'           - = ƒECREASE TEMPO'           + = …NCREASE TEMPO'      Õ≈«¡+— = —UIT PROGRAM / ≈XIT ≈NV ≈DITOR'          ∆1 = ÃOAD'          ∆3 = ”AVE'          ∆7 = ≈NVELOPE EDITOR'          ∆8 = ∆ILTER EDITORTRAP RUNSTOPØTRAPPER.DECLARATIONS'------------#DECLARE CHUNKØIDX = 0#DECLARE CHUNKØCNT = 0#DEFINE CHUNKØMAX = 20#DECLARE VIDX, IDX#DECLARE CURSORØX = 0#DECLARE CURSORØY = 0#DECLARE V$(5,CHUNKØMAX)#DECLARE KEY$#DECLARE VALID$="CDEFGAB0123456789 #$.HIQRSWOTUXMPL"#DECLARE VAL$#DECLARE TMPO% = 12#DECLARE ESCØFLAG% = 0#STRUCT ≈Œ÷‘Ÿ–≈ NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW≈Œ÷‘Ÿ–≈ ENVS(9) = [ _  [ "–IANO",       0,  9,  0,  0,  2, 1536 ], _  [ "¡CCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "√ALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "ƒRUM",        0,  5,  5,  0,  3,    0 ], _  [ "∆LUTE",       9,  4,  4,  0,  0,    0 ], _  [ "«UITAR",      0,  9,  2,  1,  1,    0 ], _  [ "»ARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "œRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "‘RUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ÿYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DEFINE ƒ…“ØŒœŒ≈ = 0#DEFINE ƒ…“Ø’–   = 1#DEFINE ƒ…“Øƒœ◊Œ = 2#DEFINE ƒ…“Øœ”√  = 3#DEFINE ∆Øœ∆∆ = 0#DEFINE ∆ØœŒ  = 1#STRUCT ∆…Ã‘‘Ÿ–≈ NAME$, FREQ, LP, BP, HP, RES, DIR, MIN, SWEEP∆…Ã‘‘Ÿ–≈ FILT(10) = [ _  [ "LOWPØUP",    1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Ø’–,   100, 10 ], _  [ "LOWPØDOWN",  1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "LOWPØOSC",   1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Øœ”√,  100, 10 ], __  [ "BANDPØUP",   1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Ø’–,   100, 10 ], _  [ "BANDPØDOWN", 1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "BANDPØOSC",  1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Øœ”√,  100, 10 ], __  [ "HIGHPØUP",   1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Ø’–,   100, 10 ], _  [ "HIGHPØDOWN", 1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "HIGHPØOSC",  1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Øœ”√,  100, 10 ], __  [ "SPAREØ1",    0,    ∆Øœ∆∆, ∆Øœ∆∆, ∆Øœ∆∆, 0,  ƒ…“ØŒœŒ≈, 0,   0  ], _  [ "SPAREØ2",    0,    ∆Øœ∆∆, ∆Øœ∆∆, ∆Øœ∆∆, 0,  ƒ…“ØŒœŒ≈, 0,   0  ], __]#DECLARE ROW, COL, SROW, SCOL, A$, V, MAXV, V$#STRUCT À≈ŸØ‘Ÿ–≈ IN$, OUT$À≈ŸØ‘Ÿ–≈ KEYS(11) = [ _  [ "A", "C", ], _  [ "W", "#C", ], _  [ "S", "D", ], _  [ "E", "#D", ], _  [ "D", "E", ], _  [ "F", "F", ], _  [ "T", "#F", ], _  [ "G", "G", ], _  [ "Y", "#G", ], _  [ "H", "A", ], _  [ "U", "#A", ], _  [ "J", "B", ] _]#DECLARE PSTR$, K, DELTA#DECLARE WNAME$(4)WNAME$(0) = "‘“…"WNAME$(1) = "”¡◊"WNAME$(2) = "–’Ã”≈"WNAME$(3) = "Œœ…”≈"WNAME$(4) = "“…Œ«"#DECLARE FILTØSTATEØNAME$(2)FILTØSTATEØNAME$(0) = "œ∆∆"FILTØSTATEØNAME$(1) = "œŒ"#DECLARE FPRESET = 1#DECLARE FSCOL = 0, FSROW = 0, FFOCUS = 0, FSEL = -1#DECLARE OCT = 5#DECLARE CURRØFREQ, CURRØDIR.DURATION'--------#DEFINE ƒŒ¡Õ≈ = 0#DEFINE ƒ√»¡“ = 1#DEFINE ƒÀ≈Ÿ  = 2#DEFINE ƒØ◊»œÃ≈ = 0#DEFINE ƒØ»¡Ã∆ = 1#DEFINE ƒØ—’¡“‘≈“ = 2#DEFINE ƒØ≈…«»‘» = 3#DEFINE ƒØ”…ÿ‘≈≈Œ‘» = 4#DECLARE SDUR = 2#DECLARE DUR$(5,2)DUR$(ƒØ◊»œÃ≈, ƒŒ¡Õ≈) = "WHOLE"DUR$(ƒØ◊»œÃ≈, ƒ√»¡“) = "W"DUR$(ƒØ◊»œÃ≈, ƒÀ≈Ÿ)  = "1"DUR$(ƒØ»¡Ã∆, ƒŒ¡Õ≈) = "HALF"DUR$(ƒØ»¡Ã∆, ƒ√»¡“) = "H"DUR$(ƒØ»¡Ã∆, ƒÀ≈Ÿ)  = "2"DUR$(ƒØ—’¡“‘≈“, ƒŒ¡Õ≈) = "QUARTER"DUR$(ƒØ—’¡“‘≈“, ƒ√»¡“) = "Q"DUR$(ƒØ—’¡“‘≈“, ƒÀ≈Ÿ)  = "3"DUR$(ƒØ≈…«»‘», ƒŒ¡Õ≈) = "EIGHTH"DUR$(ƒØ≈…«»‘», ƒ√»¡“) = "I"DUR$(ƒØ≈…«»‘», ƒÀ≈Ÿ)  = "4"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒŒ¡Õ≈) = "SIXTEENTH"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒ√»¡“) = "S"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒÀ≈Ÿ)  = "5".KEYS'----#DEFINE À≈ŸØ’– = "ë"#DEFINE À≈ŸØƒœ◊Œ = ""#DEFINE À≈ŸØÃ≈∆‘ = "ù"#DEFINE À≈ŸØ“…«»‘ = ""#DEFINE À≈ŸØƒ≈Ã = ""#DEFINE À≈ŸØ√‘“ÃØ◊ = ""#DEFINE À≈ŸØ√‘“ÃØ’ = ""#DEFINE À≈ŸØÕ≈«¡Ø— = "´"#DEFINE À≈ŸØ∆1 = "Ö"#DEFINE À≈ŸØ∆3 = "Ü"#DEFINE À≈ŸØ∆4 = "ä"#DEFINE À≈ŸØ∆7 = "à"#DEFINE À≈ŸØ∆8 = "å"#DEFINE À≈ŸØ“≈‘’“Œ = CHR$(13)#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE À≈ŸØ”»…∆‘Ø“≈‘’“Œ = CHR$(141)#DEFINE À≈ŸØ”»…∆‘Ø–Ã’” = "€"#DEFINE À≈ŸØ”»…∆‘ØÕ…Œ’” = "›"#DEFINE À≈ŸØ“≈÷ØœŒ = ""#DEFINE À≈ŸØ“≈÷Øœ∆∆ = "í"#DEFINE À≈ŸØ‘¡¬ = CHR$(9).INIT'----PRINT "ì"PLAY : PLAY "".MAIN'----  KEY OFF  GOSUB DRAWØEDITORØSCREEN  GOSUB USERØINPUT  GOTO MAIN.DRAWØEDITORØSCREEN'------------------  CURSOR 0,0:PRINT "PLAYMAKER V0.01 - BY  GURCE ISIKYILDIZ"  GOSUB DRAWØCURRENTØCHUNK  RETURN.DRAWØCURRENTØCHUNK'------------------  PRINT "ì"  PRINT "TEMPO:      ùùùùù"; TMPO%  PRINT "CHUNKØIDX:    ùùù"; CHUNKØIDX       FOR VIDX=0 TO 5    IF CURSORØY <> VIDX THEN BEGIN      CURSOR 0,5+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX;": ";V$(VIDX,CHUNKØIDX);    BEND:ELSE BEGIN      CURSOR 0,5+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX;": ";      FOR IDX=1 TO LEN(V$(VIDX,CHUNKØIDX))        IF CURSORØX = IDX-1 THEN BEGIN          PRINT "";MID$(V$(VIDX,CHUNKØIDX),IDX,1);"í";        BEND:ELSE BEGIN          PRINT MID$(V$(VIDX,CHUNKØIDX),IDX,1);        BEND      NEXT IDX      IF LEN(V$(VIDX,CHUNKØIDX)) = 0 OR CURSORØX=LEN(V$(VIDX,CHUNKØIDX)) THEN PRINT " í";    BEND  NEXT VIDX  RETURN.CHECKØVALIDØKEY'---------------  FOR IDX=1 TO LEN(VALID$)    VAL$=MID$(VALID$,IDX,1)    IF KEY$= VAL$ THEN BEGIN      IF CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN        V$(CURSORØY,CHUNKØIDX) = LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX) _          + VAL$ + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)        CURSORØX=CURSORØX+1        RETURN      BEND      V$(CURSORØY,CHUNKØIDX)=V$(CURSORØY,CHUNKØIDX)+VAL$      CURSORØX=CURSORØX+1      RETURN    BEND  NEXT IDX  RETURN.FORWARDØWORD'------------  IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  RETURN.PREVIOUSØWORD'-------------  IF CURSORØX = 0 THEN RETURN  IF CURSORØX = 1 THEN CURSORØX = 0: RETURN  CURSORØX = CURSORØX - 1  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  CURSORØX=CURSORØX+1  RETURN.LOAD'----  INPUT "LOAD NAME: ";KEY$  IF KEY$="" THEN RETURN  DOPEN #2,(KEY$),R,U8  PRINT "LOAD MELODY"  ' LOAD MELODY CHUNKS  ' ------------------  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    PRINT "CHUNKØIDX=";CHUNKØIDX;", ";    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  PRINT: PRINT "GET TEMPO"  INPUT #2,TMPO%    PRINT "LOAD ENVELOPES"  ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT "ROW=";ROW;", ";    INPUT #2, ENVSØNAME$(ROW)    INPUT #2, ENVSØATTACK(ROW)    INPUT #2, ENVSØDECAY(ROW)    INPUT #2, ENVSØSUSTAIN(ROW)    INPUT #2, ENVSØRELEASE(ROW)    INPUT #2, ENVSØWAVEFORM(ROW)    INPUT #2, ENVSØPW(ROW)    GOSUB SETØENV  NEXT ROW  PRINT  DCLOSE #2  GET KEY A$  CHUNKØIDX = 0  RETURN.SAVE'----  INPUT "SAVE NAME: ";KEY$  IF KEY$="" THEN RETURN    DELETE (KEY$)  DOPEN #2,(KEY$),W,U8  ' SAVE MELODY CHUNKS  ' ------------------  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    FOR VIDX=0 TO 5      PRINT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  PRINT #2,TMPO%  ' SAVE ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT #2, ENVSØNAME$(ROW)    PRINT #2, ENVSØATTACK(ROW)    PRINT #2, ENVSØDECAY(ROW)    PRINT #2, ENVSØSUSTAIN(ROW)    PRINT #2, ENVSØRELEASE(ROW)    PRINT #2, ENVSØWAVEFORM(ROW)    PRINT #2, ENVSØPW(ROW)  NEXT ROW  DCLOSE #2  CHUNKØIDX = 0  RETURN.SAVEØASØTEXT'------------  INPUT "SAVE (AS TEXT) NAME: ";KEY$  IF KEY$="" THEN RETURN  DELETE (KEY$)      DOPEN #2,(KEY$),W,U8  FOR CHUNKØIDX = 0 TO CHUNKØMAX-1    FOR VIDX=0 TO 5      PRINT #2, "V";CHR$(49+VIDX);"$(";STR$(CHUNKØIDX);")=";      PRINT #2, CHR$(34);V$(VIDX, CHUNKØIDX);CHR$(34)    NEXT VIDX      PRINT #2, ""  NEXT CHUNKØIDX  DCLOSE #2  CHUNKØIDX = 0  RETURN.USERØINPUT'----------  GETKEY KEY$  ' DOWN ARROW?  IF KEY$ = À≈ŸØƒœ◊Œ AND CURSORØY<5 THEN BEGIN    CURSORØY = CURSORØY + 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN CURSORØX = _      LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' UP ARROW?  IF KEY$ = À≈ŸØ’– AND CURSORØY>0 THEN BEGIN    CURSORØY = CURSORØY - 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN _      CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' RIGHT ARROW?  IF KEY$ = À≈ŸØ“…«»‘ AND CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN    CURSORØX=CURSORØX+1  BEND  ' LEFT ARROW?  IF KEY$ = À≈ŸØÃ≈∆‘ AND CURSORØX > 0 THEN CURSORØX=CURSORØX-1  ' BACKSPACE (INST/DEL)?  IF KEY$ = À≈ŸØƒ≈Ã AND CURSORØX > 0 THEN BEGIN    V$(CURSORØY,CHUNKØIDX)=LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX-1) _      + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)    CURSORØX=CURSORØX-1  BEND  IF ESCØFLAG% THEN BEGIN    ESCØFLAG%=0    IF KEY$ = "J" THEN BEGIN:CURSORØX=0:BEND    IF KEY$ = "K" THEN BEGIN:CURSORØX=LEN(V$(CURSORØY,CHUNKØIDX)):BEND    KEY$=""  BEND  IF KEY$ = À≈ŸØ≈”√¡–≈ THEN ESCØFLAG%=ABS(ESCØFLAG%-1)  ' CTRL-W = FORWARD ONE WORD  IF KEY$ = À≈ŸØ√‘“ÃØ◊ THEN GOSUB FORWARDØWORD  ' CTRL-U = BACK ONE WORD  IF KEY$ = À≈ŸØ√‘“ÃØ’ THEN GOSUB PREVIOUSØWORD  ' < / > = PREVIOUS/NEXT CHUNK  IF KEY$ = "<" AND CHUNKØIDX>0 THEN BEGIN    CHUNKØIDX=CHUNKØIDX-1    CURSORØX=0  BEND  IF KEY$ = ">" AND CHUNKØIDX<CHUNKØMAX THEN BEGIN    CHUNKØIDX=CHUNKØIDX+1    CURSORØX=0  BEND  ' +/- = TEMPO CHANGE  IF KEY$="-" THEN TMPO%=TMPO%-1  IF KEY$="+" THEN TMPO%=TMPO%+1  ' MEGA-Q = EXIT  IF KEY$ = À≈ŸØÕ≈«¡Ø— THEN BEGIN    PRINT "ARE YOU SURE? (Y/N)"    GET KEY A$    IF A$="Y" THEN KEY ON:END  BEND  IF KEY$ = À≈ŸØ∆1 THEN GOSUB LOAD  IF KEY$ = À≈ŸØ∆3 THEN GOSUB SAVE  IF KEY$ = À≈ŸØ∆7 THEN GOSUB ENVELOPEØEDITOR  ' ∆4 = SAVE AS TEXT  IF KEY$ = À≈ŸØ∆4 THEN GOSUB SAVEØASØTEXT  ' RETURN=PLAY ROW  IF KEY$ = À≈ŸØ“≈‘’“Œ THEN TEMPO TMPO% : PLAY V$(CURSORØY,CHUNKØIDX)  ' SHIFT+RETURN=PLAY ALL CHANNELS  IF KEY$ = À≈ŸØ”»…∆‘Ø“≈‘’“Œ THEN BEGIN    TEMPO TMPO%    PLAY V$(0,CHUNKØIDX), V$(1,CHUNKØIDX), _    V$(2,CHUNKØIDX), V$(3,CHUNKØIDX), V$(4,CHUNKØIDX), _    V$(5,CHUNKØIDX)  BEND  GOSUB CHECKØVALIDØKEY  RETURN.ENVELOPEØEDITOR'---------------  DO WHILE 1    GOSUB DRAWØTABLE    GOSUB GETØUSERØINPUTØFORØTABLE    ' ALT+Q TO EXIT    IF A$ = À≈ŸØÕ≈«¡Ø— THEN EXIT  LOOP  RETURN.DRAWØTABLE'----------  PRINT "ìENV EDITOR";À≈ŸØ‘¡¬;DUR$(SDUR, ƒŒ¡Õ≈);À≈ŸØ‘¡¬;"OCTAVE";OCT  PRINT "----------"  PRINT  PRINT "   Œ¡Õ≈";À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;"¡‘‘¡√À";À≈ŸØ‘¡¬;"ƒ≈√¡Ÿ";À≈ŸØ‘¡¬;"”’”‘¡…Œ";À≈ŸØ‘¡¬;"“≈Ã≈¡”≈";À≈ŸØ‘¡¬;  PRINT "◊¡÷≈∆“Õ";À≈ŸØ‘¡¬;"–’Ã”≈◊…ƒ‘»"  FOR ROW = 0 TO 9    PRINT ROW;" : ";    COL = 0 : V$ = ENVSØNAME$(ROW)    GOSUB SHOWØCELL    COL = 1 : V = ENVSØATTACK(ROW)    GOSUB SHOWØCELL    COL = 2 : V = ENVSØDECAY(ROW)    GOSUB SHOWØCELL    COL = 3 : V = ENVSØSUSTAIN(ROW)    GOSUB SHOWØCELL    COL = 4 : V = ENVSØRELEASE(ROW)    GOSUB SHOWØCELL    COL = 5 : V = ENVSØWAVEFORM(ROW)    GOSUB SHOWØCELL    COL = 6 : V = ENVSØPW(ROW)    GOSUB SHOWØCELL    PRINT  NEXT ROW  PRINT  PRINT "FILTER EDITOR"  PRINT "-------------";  PRINT À≈ŸØ‘¡¬;"FREQ";À≈ŸØ‘¡¬;"LP";À≈ŸØ‘¡¬;"BP";À≈ŸØ‘¡¬;"HP";À≈ŸØ‘¡¬;"RES";  PRINT À≈ŸØ‘¡¬;"DIR";À≈ŸØ‘¡¬;"MIN";À≈ŸØ‘¡¬;"SWEEP"  FOR FPRESET = 0 TO 10    GOSUB SHOWØFILTER  NEXT FPRESET  RETURN.SHOWØFILTER'-----------  IF FSEL = FPRESET THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØNAME$(FPRESET);": ";À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 0 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØFREQ(FPRESET);À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 1 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØSTATEØNAME$(FILTØLP(FPRESET));À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 2 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØSTATEØNAME$(FILTØBP(FPRESET));À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 3 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØSTATEØNAME$(FILTØHP(FPRESET));À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 4 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØRES(FPRESET);À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 5 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØDIR(FPRESET);À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 6 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØMIN(FPRESET);À≈ŸØ‘¡¬;  IF FSROW = FPRESET AND FSCOL = 7 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  PRINT FILTØSWEEP(FPRESET);  PRINT À≈ŸØ“≈÷Øœ∆∆  RETURN.GETØVAL'-------  IF SCOL = 0 THEN V$ = ENVSØNAME$(SROW)  IF SCOL = 1 THEN V = ENVSØATTACK(SROW)  IF SCOL = 2 THEN V = ENVSØDECAY(SROW)  IF SCOL = 3 THEN V = ENVSØSUSTAIN(SROW)  IF SCOL = 4 THEN V = ENVSØRELEASE(SROW)  IF SCOL = 5 THEN V = ENVSØWAVEFORM(SROW)  IF SCOL = 6 THEN V = ENVSØPW(SROW)  RETURN.SHOWØCELL'---------  IF SROW=ROW AND SCOL = COL THEN PRINT "";:ELSE PRINT "í";  IF COL = 0 THEN BEGIN    PRINT V$;CHR$(9);"í";    RETURN  BEND  IF COL = 5 THEN BEGIN    PRINT WNAME$(V);CHR$(9);"í";    RETURN  BEND  ' ELSE  PRINT V;CHR$(9);"í";  RETURN.GETØUSERØINPUTØFORØTABLE'------------------------  ' GET KEY A$  GOSUB READØKEYØLOOP  IF A$ = À≈ŸØÃ≈∆‘ AND SCOL > 0 THEN SCOL = SCOL - 1  IF A$ = À≈ŸØ“…«»‘ AND SCOL < 6 THEN SCOL = SCOL + 1  IF A$ = À≈ŸØ’– AND SROW > 0 THEN SROW = SROW - 1  IF A$ = À≈ŸØƒœ◊Œ AND SROW < 9 THEN SROW = SROW + 1  IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCRØVAL  IF A$ = "-" THEN DELTA=1 : GOSUB DECRØVAL  IF A$ = À≈ŸØ”»…∆‘Ø–Ã’” THEN DELTA=100 : GOSUB INCRØVAL  IF A$ = À≈ŸØ”»…∆‘ØÕ…Œ’” THEN DELTA=100 : GOSUB DECRØVAL  IF A$ = CHR$(13) AND SCOL = 0 THEN GOSUB CHANGEØENVØNAME  IF A$ = À≈ŸØ‘¡¬ THEN FFOCUS = 1 : GOSUB GETØUSERØINPUTØFORØFILTERS  GOSUB CHECKØDURATIONØCHANGE  GOSUB CHECKØPIANOØKEYS  RETURN.GETØUSERØINPUTØFORØFILTERS'--------------------------  DO WHILE 1    GOSUB DRAWØTABLE    ' GET KEY A$    GOSUB READØKEYØLOOP    IF A$ = À≈ŸØÃ≈∆‘ AND FSCOL > 0 THEN FSCOL = FSCOL - 1    IF A$ = À≈ŸØ“…«»‘ AND FSCOL < 7 THEN FSCOL = FSCOL + 1    IF A$ = À≈ŸØ’– AND FSROW > 0 THEN FSROW = FSROW - 1    IF A$ = À≈ŸØƒœ◊Œ AND FSROW < 10 THEN FSROW = FSROW + 1    IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCRØFVAL    IF A$ = "-" THEN DELTA=1 : GOSUB DECRØFVAL    IF A$ = À≈ŸØ”»…∆‘Ø–Ã’” THEN DELTA = 100 : GOSUB INCRØFVAL    IF A$ = À≈ŸØ”»…∆‘ØÕ…Œ’” THEN DELTA = 100 : GOSUB DECRØFVAL    IF A$ = À≈ŸØ“≈‘’“Œ THEN BEGIN      IF FSEL = FSROW THEN FSEL = -1:ELSE FSEL = FSROW      GOSUB APPLYØSELECTEDØFILTER    BEND    IF A$ = À≈ŸØ‘¡¬ OR A$ = À≈ŸØÕ≈«¡Ø— THEN EXIT    GOSUB CHECKØDURATIONØCHANGE    GOSUB CHECKØPIANOØKEYS  LOOP  FFOCUS = 0  RETURN.READØKEYØLOOP'-------------  A$ = ""  DO WHILE A$=""    GET A$    IF FSEL <> -1 THEN BEGIN      GOSUB UPDATEØSELECTEDØFILTER    BEND  LOOP  RETURN.CHECKØDURATIONØCHANGE'---------------------  FOR K = ƒØ◊»œÃ≈ TO ƒØ”…ÿ‘≈≈Œ‘»    IF A$ = DUR$(K, ƒÀ≈Ÿ) THEN SDUR = K  NEXT K  ' CHECK OCTAVE TOO  IF A$ = ">" AND OCT < 6 THEN OCT = OCT + 1  IF A$ = "<" AND OCT > 0 THEN OCT = OCT - 1  RETURN.UPDATEØSELECTEDØFILTER'----------------------  IF FSEL = -1 THEN RETURN  IF CURRØDIR = ƒ…“ØŒœŒ≈ THEN RETURN  PRINT "";CHR$(27);"QCURRØFREQ=";CURRØFREQ;    ' Œœ‘≈: √AN'T USE ”≈‘¬…‘ FOR ”…ƒ REGISTERS AS THE REGS ARE WRITE-ONLY  '       (”≈‘¬…‘ WILL INTERNALLY NEED A READ PRIOR TO THE WRITE)  ' ¬’«? … COULDN'T DO –œÀ≈ $ƒ415 (IT BECAME 868691 = $ƒ4153 ?!)  POKE 54293, CURRØFREQ AND 7  POKE 54294, CURRØFREQ >> 3  'POKE $D418, 16 + 10  'POKE $D417, 1  POKE 54293, CURRØFREQ AND 7  POKE 54294, CURRØFREQ >> 3  'POKE $D438, 16 + 10  'POKE $D437, 1  IF CURRØDIR = ƒ…“Ø’– THEN BEGIN    CURRØFREQ = CURRØFREQ + FILTØSWEEP(FSEL)    IF CURRØFREQ > FILTØFREQ(FSEL) THEN BEGIN      CURRØFREQ = FILTØFREQ(FSEL)      IF FILTØDIR(FSEL) = ƒ…“Øœ”√ THEN CURRØDIR = ƒ…“Øƒœ◊Œ      IF FILTØDIR(FSEL) = ƒ…“Ø’– THEN CURRØFREQ = FILTØMIN(FSEL)    BEND    RETURN  BEND  IF CURRØDIR = ƒ…“Øƒœ◊Œ THEN BEGIN    CURRØFREQ = CURRØFREQ - FILTØSWEEP(FSEL)    IF CURRØFREQ < FILTØMIN(FSEL) THEN BEGIN      CURRØFREQ = FILTØMIN(FSEL)      IF FILTØDIR(FSEL) = ƒ…“Øœ”√ THEN CURRØDIR = ƒ…“Ø’–      IF FILTØDIR(FSEL) = ƒ…“Øƒœ◊Œ THEN CURRØFREQ = FILTØFREQ(FSEL)    BEND    RETURN  BEND  RETURN.APPLYØSELECTEDØFILTER'---------------------  CURRØFREQ = FILTØFREQ(FSROW)  CURRØDIR = ƒ…“ØŒœŒ≈  IF   FILTØDIR(FSROW) = ƒ…“Ø’– _    OR FILTØDIR(FSROW) = ƒ…“Øœ”√ THEN BEGIN    CURRØFREQ = FILTØMIN(FSROW)    CURRØDIR = ƒ…“Ø’–  BEND  IF FILTØDIR(FSROW) = ƒ…“Øƒœ◊Œ THEN BEGIN    CURRØDIR = ƒ…“Øƒœ◊Œ  BEND  FILTER 1, FILTØFREQ(FSROW), FILTØLP(FSROW), _          FILTØBP(FSROW), FILTØHP(FSROW), FILTØRES(FSROW)  FILTER 2, FILTØFREQ(FSROW), FILTØLP(FSROW), _          FILTØBP(FSROW), FILTØHP(FSROW), FILTØRES(FSROW)  RETURN.CHANGEØENVØNAME'---------------  INPUT "NEW NAME: ",V$  IF V$<>"" THEN ENVSØNAME$(SROW) = V$  RETURN.CHECKØPIANOØKEYS'----------------  ' APPLY FILTER  PSTR$ = "X0"  IF FSEL <> -1 THEN PSTR$ = "X1"  ' DECIDE NOTE LENGTH  PSTR$ = PSTR$ + DUR$(SDUR, ƒ√»¡“)  ' DECIDE OCTAVE  PSTR$ = PSTR$ + "O" + STR$(OCT)  ' WHICH NOTE TO PLAY  FOR K = 0 TO 11    IF A$ = KEYSØIN$(K) THEN PSTR$ = PSTR$ + KEYSØOUT$(K)  NEXT K  IF LEN(PSTR$)>0 THEN BEGIN    PLAY "T"+STR$(SROW)+PSTR$  BEND  RETURN.INCRØVAL'--------  GOSUB GETØVAL  MAXV = 15  IF SCOL = 5 THEN MAXV = 4  IF SCOL = 6 THEN MAXV = 4095  V = V + DELTA  IF V > MAXV THEN V = MAXV  GOSUB APPLYØVAL  RETURN.DECRØVAL'--------  GOSUB GETØVAL  V = V - DELTA  IF V < 0 THEN V = 0  GOSUB APPLYØVAL  RETURN.INCRØFVAL'---------  IF FSCOL = 0 THEN BEGIN    V = FILTØFREQ(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILTØFREQ(FSROW) = V  BEND  IF FSCOL = 1 THEN FILTØLP(FSROW) = 1  IF FSCOL = 2 THEN FILTØBP(FSROW) = 1  IF FSCOL = 3 THEN FILTØHP(FSROW) = 1  IF FSCOL = 4 THEN BEGIN    V = FILTØRES(FSROW) + DELTA    IF V > 15 THEN V = 15    FILTØRES(FSROW) = V  BEND  GOSUB APPLYØSELECTEDØFILTER  RETURN.DECRØFVAL'---------  IF FSCOL = 0 THEN BEGIN    V = FILTØFREQ(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØFREQ(FSROW) = V  BEND  IF FSCOL = 1 THEN FILTØLP(FSROW) = 0  IF FSCOL = 2 THEN FILTØBP(FSROW) = 0  IF FSCOL = 3 THEN FILTØHP(FSROW) = 0  IF FSCOL = 4 THEN BEGIN    V = FILTØRES(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØRES(FSROW) = V  BEND  GOSUB APPLYØSELECTEDØFILTER  RETURN.APPLYØVAL'---------  IF SCOL=0 THEN ENVSØNAME$(SROW) = V$  IF SCOL=1 THEN ENVSØATTACK(SROW) = V  IF SCOL=2 THEN ENVSØDECAY(SROW) = V  IF SCOL=3 THEN ENVSØSUSTAIN(SROW) = V  IF SCOL=4 THEN ENVSØRELEASE(SROW) = V  IF SCOL=5 THEN ENVSØWAVEFORM(SROW) = V  IF SCOL=6 THEN ENVSØPW(SROW) = V  ROW = SROW  GOSUB SETØENV  RETURN.SETØENV'-------  ENVELOPE ROW, ENVSØATTACK(ROW), ENVSØDECAY(ROW), ENVSØSUSTAIN(ROW), ENVSØRELEASE(ROW), ENVSØWAVEFORM(ROW), ENVSØPW(ROW)  RETURN.RUNSTOPØTRAPPER'---------------  IF ER=30 THEN RESUME  ' IGNORE RUN/STOP  TRAP  PRINT ERR$(ER);" ERROR"  PRINT " IN LINE";EL  KEY ON  END